# Capstone I: Bankruptcy Prediction

This project is part of my Springboard Data Science Bootcamp, focusing on predicting corporate bankruptcy using machine learning techniques and financial ratios. The objective is to develop a reliable model that identifies companies at risk of bankruptcy to aid decision-making for stakeholders.

## Objective
Predict the likelihood of bankruptcy for companies based on their financial metrics, aiming to assist investors, creditors, and policymakers in making informed decisions.

## Dataset
- **Source**: The dataset includes financial ratios and indicators for various companies.  
- **Features**: 
  - Financial ratios related to stability, profitability, growth, and activity.
  - A single categorical feature: `Liability-Assets_Flag`.
  - Total features after preprocessing: 112.
- **Target**: Binary variable indicating bankruptcy (`1` for bankrupt, `0` for non-bankrupt).

## Methodology
### 1. **Data Preprocessing**
- Detected outliers using z-scores and interquartile range but retained them for analysis.
- Resolved class imbalance:
  - Applied SMOTE (Synthetic Minority Oversampling Technique) to increase the minority class proportion from 3%.

### 2. **Feature Engineering**
- Created new features by combining financial ratios (e.g., stability and profitability indicators).
- Generated dummy variables for numerical features to indicate outliers.
- Selected significant features using LASSO regression & Random Forest:

### 3. **Modeling**
- Machine learning models implemented:
  - **Logistic Regression**
  - **Random Forest**
  - **LightGBM**
  - **XGBoost**
  - **Balanced Random Forest**
- Tuned Hyperparameters Using Grid Search
- Evaluated models using metrics like F-beta score and recall to reflect the Asymmetry in Costs between Type I and Type II Errors

### 4. **Evaluation**
- Feature selection using Random Forest outperformed Lasso Regression in terms of model performance
- Focused on recall over precision due to the high cost of failing to predict bankruptcy.
- Best results: Balanced Random Forest Model
  - **Recall**: 0.82
  - **F-beta score**: 0.72
- Highlighted trade-offs between recall and precision to optimize business decisions.

## Key Results
- The best model is the Balanced Random Forest
- Feature engineering significantly improved model performance.
- Logistic Regression showed competitive results, balancing interpretability and predictive power.

## Technologies Used
- **Programming**: Python
- **Libraries**:
  - Data Preprocessing: pandas, numpy, scikit-learn
  - Feature Selection: statsmodels, LASSO
  - Modeling: scikit-learn, LightGBM, XGBoost
- **Visualization**: matplotlib, seaborn

---
## Future Applications: Calculating CECL Using the Predicted Probability of Default  
*(Note: The following content is not included in the main body of this project but is intended to suggest potential applications and areas for further research.)*

### **What is CECL?**  
**CECL (Current Expected Credit Loss)** is a forward-looking accounting standard introduced by the Financial Accounting Standards Board (FASB) to estimate the expected credit losses over the life of a financial asset. CECL requires financial institutions to consider both historical data and forward-looking information, making it a more comprehensive approach to credit risk management compared to previous standards.

The core formula for CECL is:

CECL = SUM(EAD × PD × LGD)


### **How Does This Project Relate to CECL?**  
This project predicts **Probability of Default (PD)**, which is a critical component in CECL calculation. The PD values generated by the model can be directly integrated into the CECL framework to estimate expected credit losses for financial institutions.

---

### **Components of CECL**  
1. **PD (Probability of Default):**
   - Represents the likelihood of a borrower defaulting over a specified time horizon.
   - Predicted by the machine learning model in this project using financial ratios.

2. **EAD (Exposure at Default):**
   - The total value exposed to credit risk at the time of default.
   - Examples of EAD calculations:
     - **Fixed Loans**: Equals the outstanding balance.
     - **Revolving Credit Lines**:  
       ```
       EAD = Current Balance + (Unused Limit × Credit Conversion Factor (CCF))
       ```
       Where CCF reflects the likelihood of the unused portion being utilized before default.

3. **LGD (Loss Given Default):**
   - The portion of the EAD expected to be lost after accounting for recoveries.
   - Examples of LGD calculations:
     - **Secured Loans**:  
       ```
       LGD = 1 - (Recovery Amount / EAD)
       ```
       Recovery Amount includes collateral value after adjusting for recovery costs.
     - **Unsecured Loans**: Estimated using historical average recovery rates.

---

### **How to Use Predicted PD for CECL Calculation**  
1. **Combine Model Output with EAD and LGD:**
   - Use the predicted PD from this project.
   - Obtain EAD from loan data and LGD from historical recovery patterns or collateral information.

2. **Apply the CECL Formula:**
   For each loan or exposure:  

Expected Loss = PD × LGD × EAD

Aggregate the expected losses across all loans to compute the total CECL:  

CECL = SUM(PD × LGD × EAD)


---

### **Example Calculation**  
- **Scenario:** A financial institution holds a portfolio with the following data:  
- Predicted **PD** = 5% (0.05)  
- **EAD** = $100,000  
- **LGD** = 40% (0.40)  

- **Calculation:**  
Expected Loss = 0.05 × 0.40 × 100,000 = 2,000

The expected credit loss for this loan is $2,000. Repeat for all loans to compute the portfolio-level CECL.

---

### **Applications and Future Research**  
- **Applications:**
- Integrate this project’s PD model into financial institutions’ CECL frameworks to improve credit risk estimation and compliance with FASB standards.
- Use CECL estimates to guide loan provisioning strategies.

- **Future Research Directions:**
- Enhance PD model performance by incorporating macroeconomic variables (e.g., interest rates, GDP growth).
- Develop models to estimate EAD and LGD for various financial products.
- Explore the impact of stress testing on CECL under adverse economic scenarios.


---

**Contact**: Suk Won Choi  
[Email: jameschoisw00@gmail.com] | [[LinkedIn Profile](https://www.linkedin.com/in/james-sukwon-choi/)]
